# é‚®ä»¶åŠ¨æ€æ—¥æœŸæ›´æ–°è¯´æ˜

## ğŸ“… æ›´æ–°æ—¥æœŸï¼š2026-01-12

## ğŸ¯ æ›´æ–°ç›®çš„
å°† n8n é‚®ä»¶èŠ‚ç‚¹ä¸­ç¡¬ç¼–ç çš„æ—¥æœŸæ›¿æ¢ä¸ºåŠ¨æ€å‚æ•°ï¼Œä½¿ç”¨æ•°æ®åº“ä¸­ `exam_sessions` è¡¨çš„ `is_active_until` æ•°æ®ã€‚

---

## âœ… å·²å®Œæˆçš„æ›´æ–°

### 1. å‰ç«¯æ•°æ®ä¼ è¾“ (script.js)

**ä½ç½®**: Lines 1903-1922

**æ–°å¢å­—æ®µ**:
```javascript
// ä»é€‰ä¸­çš„åœºæ¬¡ä¸­æå–æŠ¥åæˆªæ­¢æ—¥æœŸ (is_active_until)
const selectedVenueCheckboxes = document.querySelectorAll('input[name="selectedVenues"]:checked');
let registrationDeadline = null;
let registrationDeadlineFormatted = null;

if (selectedVenueCheckboxes.length > 0) {
    const firstCheckbox = selectedVenueCheckboxes[0];
    const deadlineStr = firstCheckbox.dataset.deadline;
    
    if (deadlineStr) {
        registrationDeadline = deadlineStr; // ISOæ ¼å¼: YYYY-MM-DD
        const deadlineDate = new Date(deadlineStr);
        const year = deadlineDate.getFullYear();
        const month = String(deadlineDate.getMonth() + 1).padStart(2, '0');
        const day = String(deadlineDate.getDate()).padStart(2, '0');
        registrationDeadlineFormatted = `${year}å¹´${month}æœˆ${day}æ—¥`;
    }
}
```

**æ·»åŠ åˆ° submitData çš„å­—æ®µ**:
```javascript
registrationDeadline: registrationDeadline, // ISOæ ¼å¼: YYYY-MM-DD
registrationDeadlineFormatted: registrationDeadlineFormatted, // æ ¼å¼åŒ–æ˜¾ç¤º: YYYYå¹´MMæœˆDDæ—¥
```

---

### 2. n8n é‚®ä»¶èŠ‚ç‚¹ HTML æ›´æ–°

#### âœï¸ ä¿®æ”¹ 1: æœ€ç»ˆå¸­ä½ç¡®è®¤æˆªæ­¢æ—¥æœŸ

**åŸæ–‡æœ¬**:
```html
ä¸ºç¡®ä¿æ‚¨çš„è€ƒè¯•å¸­ä½ï¼Œè¯·åŠ¡å¿…åœ¨ åŒ—äº¬æ—¶é—´ 2025-10-31 24:00 å‰å®Œæˆä»¥ä¸‹æ‰€æœ‰æ­¥éª¤ã€‚
```

**æ›´æ–°å**:
```html
ä¸ºç¡®ä¿æ‚¨çš„è€ƒè¯•å¸­ä½ï¼Œè¯·åŠ¡å¿…åœ¨ åŒ—äº¬æ—¶é—´ {{ $json.body.registrationDeadlineFormatted || '2025å¹´10æœˆ31æ—¥' }} 17:00 å‰å®Œæˆä»¥ä¸‹æ‰€æœ‰æ­¥éª¤ã€‚
```

**å˜æ›´è¯´æ˜**:
- âœ… æ—¥æœŸä»ç¡¬ç¼–ç  `2025-10-31` æ”¹ä¸ºåŠ¨æ€å‚æ•° `{{ $json.body.registrationDeadlineFormatted }}`
- âœ… æ—¶é—´ä» `24:00` æ”¹ä¸º `17:00`
- âœ… æ·»åŠ é»˜è®¤å€¼ `'2025å¹´10æœˆ31æ—¥'` ä½œä¸ºå…œåº•

---

#### âœï¸ ä¿®æ”¹ 2: æŠ¥åå–æ¶ˆæ”¿ç­–æˆªæ­¢æ—¥æœŸ

**åŸæ–‡æœ¬**:
```html
å¦‚éœ€å–æ¶ˆæŠ¥åï¼Œé¡»åœ¨åŒ—äº¬æ—¶é—´2025å¹´10æœˆ31æ—¥å‰ä»¥ä¹¦é¢å½¢å¼æå‡ºç”³è¯·
```

**æ›´æ–°å**:
```html
å¦‚éœ€å–æ¶ˆæŠ¥åï¼Œé¡»åœ¨åŒ—äº¬æ—¶é—´{{ $json.body.registrationDeadlineFormatted || '2025å¹´10æœˆ31æ—¥' }}å‰ä»¥ä¹¦é¢å½¢å¼æå‡ºç”³è¯·
```

**å˜æ›´è¯´æ˜**:
- âœ… æ—¥æœŸä»ç¡¬ç¼–ç  `2025å¹´10æœˆ31æ—¥` æ”¹ä¸ºåŠ¨æ€å‚æ•° `{{ $json.body.registrationDeadlineFormatted }}`
- âœ… æ·»åŠ é»˜è®¤å€¼ `'2025å¹´10æœˆ31æ—¥'` ä½œä¸ºå…œåº•

---

## ğŸ“Š æ•°æ®æµç¨‹å›¾

```
æ•°æ®åº“ (exam_sessions)
    â†“
    is_active_until (æŠ¥åæˆªæ­¢æ—¥æœŸ)
    â†“
å‰ç«¯æ¸²æŸ“åœºæ¬¡æ—¶å­˜å‚¨åˆ° data-deadline
    â†“
ç”¨æˆ·é€‰æ‹©åœºæ¬¡åæå– data-deadline
    â†“
æ ¼å¼åŒ–ä¸º registrationDeadlineFormatted (YYYYå¹´MMæœˆDDæ—¥)
    â†“
éšè¡¨å•æ•°æ®å‘é€åˆ° n8n
    â†“
n8n é‚®ä»¶èŠ‚ç‚¹ä½¿ç”¨ {{ $json.body.registrationDeadlineFormatted }}
    â†“
å­¦ç”Ÿæ”¶åˆ°å¸¦æœ‰åŠ¨æ€æ—¥æœŸçš„é‚®ä»¶
```

---

## ğŸ” æµ‹è¯•æ£€æŸ¥æ¸…å•

### å‰ç«¯æµ‹è¯•:
- [ ] é€‰æ‹©è€ƒè¯•åœºæ¬¡åï¼Œæ§åˆ¶å°è¾“å‡ºçš„ submitData ä¸­åŒ…å« `registrationDeadline` å’Œ `registrationDeadlineFormatted`
- [ ] å€¼æ ¼å¼æ­£ç¡®ï¼š`registrationDeadlineFormatted` ä¸º "YYYYå¹´MMæœˆDDæ—¥"

### n8n å·¥ä½œæµæµ‹è¯•:
- [ ] å¯¼å…¥æ›´æ–°åçš„ `OSD_Reg_Official.json` åˆ° n8n
- [ ] æµ‹è¯•è§¦å‘å·¥ä½œæµï¼Œæ£€æŸ¥é‚®ä»¶å†…å®¹
- [ ] ç¡®è®¤é‚®ä»¶ä¸­çš„ä¸¤å¤„æ—¥æœŸéƒ½æ˜¾ç¤ºä¸ºåŠ¨æ€æ—¥æœŸ
- [ ] ç¡®è®¤æ—¶é—´æ˜¾ç¤ºä¸º `17:00` è€Œé `24:00`

### é‚®ä»¶æµ‹è¯•:
- [ ] å‘é€æµ‹è¯•é‚®ä»¶ï¼ŒæŸ¥çœ‹"æœ€ç»ˆå¸­ä½ç¡®è®¤"éƒ¨åˆ†çš„æ—¥æœŸæ˜¯å¦æ­£ç¡®
- [ ] æŸ¥çœ‹"æŠ¥åå–æ¶ˆæ”¿ç­–"éƒ¨åˆ†çš„æ—¥æœŸæ˜¯å¦æ­£ç¡®
- [ ] å¦‚æœæ²¡æœ‰ `registrationDeadlineFormatted` æ•°æ®ï¼Œåº”æ˜¾ç¤ºé»˜è®¤å€¼ "2025å¹´10æœˆ31æ—¥"

---

## ğŸ“ ä½¿ç”¨çš„æ•°æ®å‚æ•°

| å‚æ•°å | æ¥æº | æ ¼å¼ | ç¤ºä¾‹ | ç”¨é€” |
|--------|------|------|------|------|
| `registrationDeadline` | exam_sessions.is_active_until | ISO (YYYY-MM-DD) | 2025-10-31 | åŸå§‹æ—¥æœŸæ•°æ® |
| `registrationDeadlineFormatted` | å‰ç«¯æ ¼å¼åŒ– | ä¸­æ–‡æ ¼å¼ | 2025å¹´10æœˆ31æ—¥ | é‚®ä»¶æ˜¾ç¤º |

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

1. **å‰ç«¯ä»£ç **:
   - âœ… `script.js` å·²åŒ…å«æŠ¥åæˆªæ­¢æ—¥æœŸæå–é€»è¾‘
   - éœ€è¦æäº¤åˆ° Git å¹¶æ¨é€åˆ° GitHub

2. **n8n å·¥ä½œæµ**:
   - âœ… `OSD_Reg_Official.json` å·²æ›´æ–°é‚®ä»¶ HTML
   - éœ€è¦åœ¨ n8n åå°é‡æ–°å¯¼å…¥æ­¤å·¥ä½œæµæ–‡ä»¶
   - æˆ–è€…æ‰‹åŠ¨ç¼–è¾‘é‚®ä»¶èŠ‚ç‚¹çš„ HTML å†…å®¹

3. **æµ‹è¯•éªŒè¯**:
   - æäº¤æµ‹è¯•æŠ¥å
   - æ£€æŸ¥æ”¶åˆ°çš„é‚®ä»¶ä¸­æ—¥æœŸæ˜¯å¦æ­£ç¡®æ˜¾ç¤º

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **é»˜è®¤å€¼å…œåº•**: æ‰€æœ‰æ—¥æœŸå‚æ•°éƒ½è®¾ç½®äº†é»˜è®¤å€¼ `'2025å¹´10æœˆ31æ—¥'`ï¼Œé˜²æ­¢æ•°æ®ç¼ºå¤±æ—¶é‚®ä»¶æŠ¥é”™
2. **æ—¶é—´ç»Ÿä¸€**: æˆªæ­¢æ—¶é—´ç»Ÿä¸€ä¸º `17:00`ï¼ˆåŸæ¥æ˜¯ `24:00`ï¼‰
3. **æ ¼å¼ä¸€è‡´**: æ‰€æœ‰æ—¥æœŸæ˜¾ç¤ºæ ¼å¼ç»Ÿä¸€ä¸º "YYYYå¹´MMæœˆDDæ—¥"
4. **æ•°æ®åº“ä¾èµ–**: ç¡®ä¿æ•°æ®åº“ä¸­ `exam_sessions` è¡¨çš„ `is_active_until` å­—æ®µæœ‰æ­£ç¡®çš„æ•°æ®

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- **å‰ç«¯**: `d:\Projects\osd_application\script.js`
- **n8nå·¥ä½œæµ**: `f:\æˆ‘çš„åšæœäº‘\B-å…¶ä»–èµ„æ–™\n8nè‡ªåŠ¨åŒ–èµ„æ–™\OSD_Reg_Official.json`
- **æ•°æ®åº“è¡¨**: `exam_sessions` (å­—æ®µ: `is_active_until`)

---

## âœ¨ ä¸‹ä¸€æ­¥ä¼˜åŒ–å»ºè®®

1. è€ƒè™‘æ·»åŠ æ—¶åŒºæ˜¾ç¤ºï¼ˆç›®å‰é»˜è®¤ä¸ºåŒ—äº¬æ—¶é—´ï¼‰
2. å¦‚æœæœ‰å¤šä¸ªåœºæ¬¡é€‰æ‹©ï¼Œå¯ä»¥è€ƒè™‘æ˜¾ç¤ºå¤šä¸ªæˆªæ­¢æ—¥æœŸ
3. åœ¨é‚®ä»¶ä¸­æ·»åŠ å€’è®¡æ—¶æé†’

---

**æ›´æ–°å®Œæˆï¼âœ…**
