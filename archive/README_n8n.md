# SDI奥德考试中心报名系统 (n8n版本)

## 系统概述

本项目为SDI成都奥德考试中心提供在线报名解决方案，使用n8n.io工作流自动化平台处理表单提交、数据存储和邮件发送。

## 功能特点

- ✅ **在线表单提交** - 基于n8n Form Trigger的专业表单
- ✅ **文件上传** - 支持签字文件上传（Word/PDF格式）
- ✅ **自动数据存储** - 直接保存到Google Sheets
- ✅ **双重邮件发送** - 给用户和管理员同时发送邮件
- ✅ **附件处理** - 邮件包含上传的签字文件
- ✅ **成功页面** - 提交后显示确认信息

## 项目结构

```
forms/
├── OSD_Reg_modified.json      # n8n工作流配置文件
├── n8n-form.html              # 前端引导页面
├── public/                    # 模板文件目录
│   └── SDI奥德考试中心报名须知.docx
└── README_n8n.md             # 本文档
```

## 快速启动

### 1. n8n工作流设置

1. 登录你的n8n实例
2. 导入 `OSD_Reg_modified.json` 工作流文件
3. 配置以下凭据：
   - **Google Sheets OAuth2** - 用于数据存储
   - **SMTP账户** - 用于邮件发送

### 2. 工作流配置

#### Google Sheets设置
- **文档ID**: `1e7IBYNKiEvdZOscI0YaBK9uk6ReymltU0bWHJZ1e3D8`
- **工作表**: Sheet1
- **列映射**: 自动映射到对应的表头

#### 邮件配置
- **管理员邮箱**: info@sdi-osd.de
- **SMTP设置**: 需要配置发送邮件的SMTP服务器

### 3. 前端页面部署

将 `n8n-form.html` 部署到你的Web服务器，用户可以通过此页面：
- 下载报名须知模板
- 查看报名说明
- 跳转到n8n表单

## 工作流程说明

### 数据流程图

```
用户填写表单 → n8n Form Trigger → 数据处理 → 三个并行操作：
                                          ├── 保存到Google Sheets
                                          ├── 发送邮件给管理员(带附件)
                                          └── 发送邮件给用户
                                          ↓
                                      显示成功页面
```

### 表单字段

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 名字（拼音） | 文本 | ✓ | 学生名字 |
| 姓氏（拼音） | 文本 | ✓ | 学生姓氏 |
| 性别 | 下拉 | ✓ | 男/女 |
| 出生日期 | 日期 | ✓ | - |
| 国籍 | 文本 | ✓ | 英文，如China |
| 出生地 | 文本 | ✓ | 拼音，与护照一致 |
| 邮箱地址 | 文本 | ✓ | 接收确认邮件 |
| 考试等级 | 下拉 | ✓ | A1/A2/B1 |
| 考试模块 | 多选 | ✓ | 根据等级选择模块 |
| 手机号码 | 文本 | ✓ | - |
| 首次参加 | 下拉 | ✓ | 是/否 |
| 护照号码 | 文本 | ✓ | 无护照填"后补" |
| 考试日期 | 下拉 | ✓ | 可选日期 |
| 签字文件 | 文件 | ✓ | .doc/.docx/.pdf |

### Google Sheets数据映射

数据会自动映射到Google Sheets的以下列：

- `ChineseName`: 完整中文姓名
- `FirstName`: 名字
- `LastName`: 姓氏  
- `Gender`: 性别
- `BirthDate`: 出生日期
- `Nationality`: 国籍
- `BirthPlace`: 出生地
- `Passport`: 护照号码
- `E-mail`: 邮箱
- `Level`: 考试等级
- `B1_Listening`, `B1_Reading`, `B1_Writing`, `B1_Speaking`: B1各模块（✓表示选择）
- `A2_Written`, `A2_Oral`: A2模块
- `A1_Written`, `A1_Oral`: A1模块
- `Mobile`: 手机号
- `First_Time`: 是否首次参加
- `Reg_Time`: 报名时间
- `TestDate`: 考试日期

## 邮件模板

### 管理员邮件
- **收件人**: info@sdi-osd.de
- **主题**: 新的奥德考试报名申请 - [学生姓名]
- **内容**: 包含所有学生信息和考试详情
- **附件**: 用户上传的签字文件

### 学生确认邮件
- **收件人**: 用户填写的邮箱
- **主题**: [学生姓名] - 奥德考试报名后续流程通知
- **内容**: 包含后续报名步骤和注意事项
- **附件**: 无

## 表单访问链接

- **n8n表单**: https://n8n.talentdual.com/form/6ff74a92-c06a-4505-9f87-29ce59bc13f4
- **引导页面**: 部署 `n8n-form.html` 后的URL

## 故障排除

### 常见问题

1. **表单提交失败**
   - 检查n8n工作流是否激活
   - 确认webhookId是否正确

2. **邮件发送失败**
   - 检查SMTP凭据配置
   - 确认邮件模板格式正确

3. **Google Sheets写入失败**
   - 检查Google Sheets OAuth2权限
   - 确认表格ID和工作表名称正确

4. **文件上传问题**
   - 确认文件格式为.doc/.docx/.pdf
   - 检查文件大小限制

### 测试建议

1. 先用测试数据提交表单
2. 检查Google Sheets是否正确接收数据
3. 确认两封邮件都能正常发送
4. 验证附件是否正确包含在管理员邮件中

## 维护说明

### 定期检查
- Google Sheets访问权限
- SMTP服务器连接状态
- n8n工作流执行状态

### 备份建议
- 定期导出Google Sheets数据
- 备份n8n工作流配置
- 保存重要邮件模板

## 技术支持

如有技术问题，请联系：
- **邮箱**: info@sdi-osd.de
- **n8n工作流**: 检查执行日志
- **Google Sheets**: 查看数据同步状态

---

**注意**: 此系统完全基于n8n.io平台，无需额外的服务器或数据库配置。所有数据处理和邮件发送都通过n8n工作流自动完成。 