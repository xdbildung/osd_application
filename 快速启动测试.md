# 🚀 快速启动本地测试

## 方法一：双击启动脚本（推荐）

### Windows PowerShell（推荐）
1. 右键点击 `start-local-server.ps1`
2. 选择"使用 PowerShell 运行"

**如果提示执行策略错误**：
```powershell
# 在 PowerShell 中以管理员身份运行：
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 然后再次运行脚本
```

### Windows 批处理
1. 双击 `start-local-server.bat`

---

## 方法二：命令行启动

### 使用 Python（任何系统）
```bash
# 在项目根目录打开命令行/终端，然后运行：
python -m http.server 8000

# 或者
python3 -m http.server 8000
```

### 使用 Node.js
```bash
node server.js
```

---

## 📍 测试地址

启动成功后，在浏览器中访问：

### 主页面（推荐）
```
http://localhost:8000/index.html
```

### Public 页面
```
http://localhost:8000/public/index.html
```

### 管理页面
```
http://localhost:8000/admin.html
```

---

## ✅ 测试要点

### 1. 打开浏览器开发者工具
按 `F12` 或右键页面选择"检查"

### 2. 查看控制台日志
应该看到：
```
🔄 正在从 Supabase 加载考试场次数据...
✅ 成功加载场次数据: X 个场次
🔄 正在从 Supabase 加载产品价格数据...
✅ 成功加载产品数据: X 个产品
```

### 3. 测试新增城市代码
在控制台中执行：
```javascript
// 测试城市代码转换
console.log(getLocationName('HZ'));  // 杭州
console.log(getLocationName('NJ'));  // 南京
console.log(getLocationName('WX'));  // 无锡
console.log(getLocationName('XA'));  // 西安
console.log(getLocationName('QD'));  // 青岛
console.log(getLocationName('ZZ'));  // 郑州

// 查看所有城市映射
console.log(LOCATION_MAPPINGS);
```

**预期输出**：
```javascript
{
  'BJ': '北京',
  'CD': '成都',
  'GZ': '广州',
  'HZ': '杭州',  // ✨ 新增
  'NJ': '南京',  // ✨ 新增
  'QD': '青岛',  // ✨ 新增
  'SH': '上海',
  'SZ': '深圳',
  'WX': '无锡',  // ✨ 新增
  'XA': '西安',  // ✨ 新增
  'ZZ': '郑州'   // ✨ 新增
}
```

### 4. 测试完整流程
1. ✅ 选择考试场次（如果有新城市场次会显示中文名称）
2. ✅ 选择考试科目
3. ✅ 输入专属代码并验证
4. ✅ 填写个人信息
5. ✅ 查看费用计算
6. ✅ 提交表单（仅测试，不会真实提交）

---

## 🗄️ 数据库测试数据（可选）

如果您想测试新城市功能，可以在 Supabase SQL Editor 中执行：

```sql
-- 添加杭州测试场次
INSERT INTO exam_sessions (date, location, levels, is_active)
VALUES ('2025-12-15', 'HZ', ARRAY['A1', 'A2'], true)
RETURNING id;

-- 记下返回的 id，然后添加产品
INSERT INTO exam_products (code, name, level, location, module_type, price_original, price_discounted, is_active)
VALUES
    ('A1_HZ_Full', 'A1全科', 'A1', 'HZ', 'Full', 160000, 140000, true),
    ('A1_HZ_Written', 'A1笔试', 'A1', 'HZ', 'Written', 95000, NULL, true),
    ('A1_HZ_Oral', 'A1口试', 'A1', 'HZ', 'Oral', 60000, NULL, true);

-- 可选：添加专属代码（替换为实际的场次UUID）
INSERT INTO coupons (code, session_id, is_active)
VALUES ('HANGZHOU2025', '替换为实际场次UUID', true);
```

**刷新页面后**，您应该能在场次列表中看到"杭州考场"。

---

## 🐛 常见问题

### 问题：端口 8000 已被占用
**解决方法**：
```bash
# 使用其他端口，例如 8080
python -m http.server 8080

# 然后访问 http://localhost:8080/index.html
```

### 问题：页面显示但无数据
**检查**：
1. 打开浏览器控制台（F12）
2. 查看是否有错误信息
3. 检查 Supabase 配置是否正确
4. 确认数据库中有活跃场次（`is_active = true`）

### 问题：专属代码验证失败
**检查**：
1. 数据库中是否存在该代码
2. 代码的 `session_id` 是否匹配当前场次
3. 代码的 `is_active` 是否为 `true`

---

## 📚 详细测试指南

完整的测试步骤和检查清单请查看：
- **TEST_GUIDE.md** - 详细测试指南
- **SUPABASE_INTEGRATION_SUMMARY.md** - 功能说明文档

---

## 🎉 新增功能总结

### ✨ 本次更新
1. **新增 6 个城市代码**：杭州(HZ)、南京(NJ)、无锡(WX)、西安(XA)、青岛(QD)、郑州(ZZ)
2. **共支持 11 个城市**：北京、成都、广州、杭州、南京、青岛、上海、深圳、无锡、西安、郑州
3. **完全动态化**：无需修改代码即可支持新城市
4. **专属代码功能**：全科考试享受折扣
5. **数据库驱动**：所有场次和价格从 Supabase 动态加载

### 🔍 测试重点
- 城市代码转换功能（代码 ↔ 中文名称）
- 数据库动态加载（场次、产品）
- 专属代码验证（仅针对特定场次）
- 费用计算（支持折扣）
- 表单提交数据完整性

---

**祝测试顺利！** 🚀

如有问题，请查看详细文档或联系开发团队。
