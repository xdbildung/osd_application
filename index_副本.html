<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>奥德考试报名表</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <h1>奥德考试报名表</h1>
        <p class="description">
            亲爱的同学们，欢迎报名参加慕尼黑SDI语言大学举办的奥德考试！✨
        </p>
        
        <form id="registrationForm">
            <div class="form-group">
                <label for="firstName">名字（拼音） <span class="required">*</span></label>
                <input type="text" id="firstName" name="firstName" required>
                <div class="error-hint" id="firstName-error"></div>
            </div>

            <div class="form-group">
                <label for="lastName">姓氏（拼音） <span class="required">*</span></label>
                <input type="text" id="lastName" name="lastName" required>
                <div class="error-hint" id="lastName-error"></div>
            </div>

            <div class="form-group">
                <label for="gender">性别 <span class="required">*</span></label>
                <select id="gender" name="gender" required>
                    <option value="">请选择...</option>
                    <option value="male">男</option>
                    <option value="female">女</option>
                </select>
                <div class="error-hint" id="gender-error"></div>
            </div>

            <div class="form-group">
                <label for="birthDate">出生日期 <span class="required">*</span></label>
                <input type="date" id="birthDate" name="birthDate" required>
                <div class="error-hint" id="birthDate-error"></div>
            </div>

            <div class="form-group">
                <label for="nationality">国籍 <span class="required">*</span></label>
                <select id="nationality" name="nationality" required>
                    <option value="">请选择...</option>
                    <option value="China">中国</option>
                    <option value="Other">其他</option>
                </select>
                <div class="error-hint" id="nationality-error"></div>
            </div>

            <div class="form-group" id="otherNationalityGroup" style="display: none;">
                <label for="otherNationality">请填写具体国籍（英文） <span class="required">*</span></label>
                <input type="text" id="otherNationality" name="otherNationality" placeholder="例如：United States">
                <div class="error-hint" id="otherNationality-error"></div>
            </div>

            <div class="form-group">
                <label for="birthPlace">出生地（拼音，请与护照保持一致） <span class="required">*</span></label>
                <input type="text" id="birthPlace" name="birthPlace" required>
                <div class="error-hint" id="birthPlace-error"></div>
            </div>

            <div class="form-group">
                <label for="email">邮箱地址 <span class="required">*</span></label>
                <input type="email" id="email" name="email" required>
                <div class="form-note">
                    📧 <strong>重要提醒：</strong>报名成功通知将通过邮件发送，请确保邮箱地址准确无误。如果在报名付费后一天内没有收到邮件，请联系 <a href="mailto:info@sdi-osd.de">info@sdi-osd.de</a>
                </div>
                <div class="error-hint" id="email-error"></div>
            </div>

            <div class="form-group">
                <label for="phoneNumber">联系电话 <span class="required">*</span></label>
                <input type="tel" id="phoneNumber" name="phoneNumber" required placeholder="请输入8位座机号或11位手机号">
                <div class="error-hint" id="phoneNumber-error"></div>
            </div>

            <div class="form-group">
                <label for="firstTimeExam">是否为第一次参加该等级考试 <span class="required">*</span></label>
                <select id="firstTimeExam" name="firstTimeExam" required>
                    <option value="">请选择...</option>
                    <option value="Yes">是</option>
                    <option value="No">否</option>
                </select>
                <div class="error-hint" id="firstTimeExam-error"></div>
            </div>

            <div class="form-group">
                <label for="passportNumber">护照号码（有效期须至少六个月；若暂无护照，可留空）</label>
                <input type="text" id="passportNumber" name="passportNumber" placeholder="请输入护照号码或留空">
                <div class="error-hint" id="passportNumber-error"></div>
            </div>

            <div class="form-group">
                <label for="passportUpload">上传护照信息页（如有）</label>
                <div class="file-upload-container">
                    <input type="file" id="passportUpload" name="passportUpload" accept=".jpg,.jpeg,.png,.pdf">
                    <label for="passportUpload" class="file-upload-label">
                        📎 选择护照信息页文件
                    </label>
                    <div class="file-info" id="passportFileInfo"></div>
                </div>
                <div class="form-note">
                    💡 支持JPG、PNG、PDF格式，文件大小不超过5MB<br>
                </div>
            </div>

            <div class="form-group">
                <label>报名考试场次 <span class="required">*</span></label>
                <div class="session-selection">
                    <label class="session-option">
                        <input type="checkbox" name="selectedVenues" value="北京" data-venue="北京" data-date="2025年9月6日">
                        <span class="session-info">
                            <strong>北京考场</strong>
                            <small>2025年9月6日</small>
                        </span>
                    </label>
                    <label class="session-option">
                        <input type="checkbox" name="selectedVenues" value="成都" data-venue="成都" data-date="2025年8月27日">
                        <span class="session-info">
                            <strong>成都考场</strong>
                            <small>2025年8月27日</small>
                        </span>
                    </label>
                </div>
                <div class="form-note">
                    💡 您可以同时选择多个考场参加不同等级的考试
                </div>
                <div class="error-hint" id="selectedVenues-error"></div>
            </div>

            <!-- 北京考场选项 -->
            <div class="form-group venue-options" id="beijingOptions" style="display: none;">
                <label>北京考场 - 2025年9月6日 考试选项</label>
                <div class="exam-venue-container">
                    <div class="level-section">
                        <h4>A1等级</h4>
                        <div class="exam-type-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="examSessions" value="A1_BJ_VIP" data-level="A1" data-location="北京">
                                <span>A1全科（VIP专场）</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="form-note">
                    💡 北京考场仅提供A1全科VIP专场
                </div>
            </div>

            <!-- 成都考场选项 -->
            <div class="form-group venue-options" id="chengduOptions" style="display: none;">
                <label>成都考场 - 2025年8月27日 考试选项</label>
                <div class="exam-venue-container">
                    <div class="level-section">
                        <h4>A1等级</h4>
                        <div class="exam-type-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="examSessions" value="A1_CD_Full" data-level="A1" data-location="成都">
                                <span>A1全科</span>
                            </label>
                            <div class="single-modules" style="margin-left: 20px;">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="A1_CD_Written" data-level="A1" data-location="成都" data-single="true">
                                    <span>A1笔试</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="A1_CD_Oral" data-level="A1" data-location="成都" data-single="true">
                                    <span>A1口试</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="level-section">
                        <h4>A2等级</h4>
                        <div class="exam-type-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="examSessions" value="A2_CD_Full" data-level="A2" data-location="成都">
                                <span>A2全科</span>
                            </label>
                            <div class="single-modules" style="margin-left: 20px;">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="A2_CD_Written" data-level="A2" data-location="成都" data-single="true">
                                    <span>A2笔试</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="A2_CD_Oral" data-level="A2" data-location="成都" data-single="true">
                                    <span>A2口试</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="level-section">
                        <h4>B1等级</h4>
                        <div class="exam-type-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="examSessions" value="B1_CD_Full" data-level="B1" data-location="成都">
                                <span>B1全科</span>
                            </label>
                            <div class="single-modules" style="margin-left: 20px;">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="B1_CD_Listening" data-level="B1" data-location="成都" data-single="true">
                                    <span>B1听力</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="B1_CD_Oral" data-level="B1" data-location="成都" data-single="true">
                                    <span>B1口语</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="B1_CD_Reading" data-level="B1" data-location="成都" data-single="true">
                                    <span>B1阅读</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="examSessions" value="B1_CD_Written" data-level="B1" data-location="成都" data-single="true">
                                    <span>B1写作</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-note">
                    💡 选择全科后，同等级的单科选项将自动禁用
                </div>
            </div>

            <button type="submit" class="submit-btn">提交报名申请</button>
        </form>

        <div id="successMessage" class="success-message hidden">
            <h2>报名申请提交成功！🎉</h2>
            <p>感谢您的报名！我们已收到您的申请。</p>
            
            <!-- 申请ID显示区域 -->
            <div class="application-id-section">
                <h3>📋 您的申请编号</h3>
                <div class="application-id">
                    <span class="id-label">申请编号：</span>
                    <span class="id-value" id="applicationIdDisplay">---</span>
                </div>
                <div class="id-note">
                    💡 请记录此编号，后续流程中会用到此编号进行身份确认
                </div>
            </div>
            
            <!-- 后续流程说明 -->
            <div class="next-steps-section">
                <h3>📧 接下来的步骤</h3>
                <div class="steps-content">
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <div class="step-text">
                            <h4 style="text-align: center;">查收邮件</h4>
                            <p style="text-align: center;">我们已向您的邮箱发送了详细的报名确认邮件，请注意查收。</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <div class="step-text">
                            <h4 style="text-align: center;">完成付费</h4>
                            <p style="text-align: center;">邮件中包含详细的付费信息和二维码，请按照邮件指引完成考试费用支付。</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <div class="step-text">
                            <h4 style="text-align: center;">签署文件</h4>
                            <p style="text-align: center;">下载邮件附件中的《考试须知》，签字后回传给我们。</p>
                        </div>
                    </div>
                    <div class="step-item">
                        <div class="step-number">4</div>
                        <div class="step-text">
                            <h4 style="text-align: center;">等待确认</h4>
                            <p style="text-align: center;">完成上述步骤后，我们将在考前5-7天发送正式的考试确认函。</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 重要提醒 -->
            <div class="important-reminder">
                <h3>⚠️ 重要提醒</h3>
                <ul>
                    <li><strong>邮件检查：</strong>如果10分钟内未收到邮件，请检查垃圾邮件文件夹</li>
                    <li><strong>截止时间：</strong>请务必在2025年8月5日前完成所有确认步骤</li>
                    <li><strong>联系方式：</strong>如有疑问，请联系 <a href="mailto:info@sdi-osd.de">info@sdi-osd.de</a></li>
                </ul>
            </div>
            
            <!-- 操作按钮 -->
            <div class="action-buttons">
                <button type="button" class="action-btn primary" onclick="window.location.reload()">
                    继续报名其他考试
                </button>
                <button type="button" class="action-btn secondary" onclick="window.close()">
                    关闭页面
                </button>
            </div>

        </div>
    </div>

    <!-- 版本信息页脚 -->
    <footer class="version-footer">
        <div class="version-info">
            <span class="version-text">奥德考试报名系统 v1.8.2</span>
            <span class="copyright">© 2025 慕尼黑SDI语言大学</span>
        </div>
    </footer>

    <!-- PDF.js库用于PDF转换功能 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // 配置PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
            console.log('📚 PDF.js库加载成功，支持PDF转JPG功能');
        }
    </script>
    
        <script src="/script.js"></script>
    
    <!-- 文件压缩处理脚本 -->
    <script>
        // 文件大小限制（1MB = 1024 * 1024 bytes）
        const MAX_FILE_SIZE = 1024 * 1024; // 1MB
        const MAX_UPLOAD_SIZE = 5 * 1024 * 1024; // 5MB
        
        // 图片压缩函数
        function compressImage(file, maxSize = MAX_FILE_SIZE) {
            return new Promise((resolve, reject) => {
                // 检查文件类型
                if (!file.type.startsWith('image/')) {
                    reject(new Error('不支持的文件类型'));
                    return;
                }
                
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    // 计算压缩比例
                    let { width, height } = img;
                    let quality = 0.9;
                    
                    // 如果图片太大，先缩小尺寸
                    const maxDimension = 1920;
                    if (width > maxDimension || height > maxDimension) {
                        const ratio = Math.min(maxDimension / width, maxDimension / height);
                        width *= ratio;
                        height *= ratio;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    // 绘制图片
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // 压缩函数
                    function compressWithQuality(quality) {
                        return new Promise((resolve) => {
                            canvas.toBlob((blob) => {
                                resolve(blob);
                            }, 'image/jpeg', quality);
                        });
                    }
                    
                    // 递归压缩直到文件大小符合要求
                    async function compressRecursive(quality) {
                        const blob = await compressWithQuality(quality);
                        
                        if (blob.size <= maxSize || quality <= 0.1) {
                            resolve(blob);
                        } else {
                            // 继续压缩，降低质量
                            await compressRecursive(quality - 0.1);
                        }
                    }
                    
                    compressRecursive(quality);
                };
                
                img.onerror = () => reject(new Error('图片加载失败'));
                img.src = URL.createObjectURL(file);
            });
        }
        
        // 处理护照文件上传
        function handlePassportFileUpload(file) {
            const fileInfo = document.getElementById('passportFileInfo');
            const fileInput = document.getElementById('passportUpload');
            
            // 显示原始文件信息
            const originalSize = (file.size / 1024 / 1024).toFixed(2);
            fileInfo.innerHTML = `
                <div style="color: #666; font-size: 14px; margin-top: 8px;">
                    📄 原始文件：${file.name} (${originalSize}MB)
                </div>
            `;
            
            // 检查文件大小
            if (file.size > MAX_UPLOAD_SIZE) {
                fileInfo.innerHTML += `
                    <div style="color: #dc3545; font-size: 14px; margin-top: 4px;">
                        ❌ 文件过大，请选择小于5MB的文件
                    </div>
                `;
                fileInput.value = '';
                return;
            }
            
            // 如果是图片且大于1MB，进行压缩
            if (file.type.startsWith('image/') && file.size > MAX_FILE_SIZE) {
                compressImage(file).then(compressedBlob => {
                    // 创建新的File对象
                    const compressedFile = new File([compressedBlob], 
                        file.name.replace(/\.[^/.]+$/, '') + '_compressed.jpg', 
                        { type: 'image/jpeg' }
                    );
                    
                    // 更新文件输入
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(compressedFile);
                    fileInput.files = dataTransfer.files;
                    
                    // 静默处理，不显示压缩信息
                }).catch(error => {
                    // 压缩失败时静默处理，不显示错误信息
                    fileInput.value = '';
                });
            }
        }
        
        // 页面加载完成后添加事件监听
        document.addEventListener('DOMContentLoaded', function() {
            const passportUpload = document.getElementById('passportUpload');
            
            if (passportUpload) {
                passportUpload.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        handlePassportFileUpload(file);
                    }
                });
            }
        });
    </script>
    
 
</body>
</html> 
</html> 