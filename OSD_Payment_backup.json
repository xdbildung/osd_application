{
  "name": "OSD_Payment",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "submit-payment",
        "options": {
          "noResponseBody": false
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [
        -1020,
        140
      ],
      "id": "d07aeb57-322b-49c8-9a5e-aea7ffbcabfc",
      "name": "Webhook Trigger",
      "webhookId": "7fce1b61-5c28-4fc9-9991-cfda7a3f4399"
    },
    {
      "parameters": {
        "jsCode": "// Process payment proof data and attachments\nconst items = $input.all();\n\nfor (let item of items) {\n  // Handle nationality field\n  if (item.json.body.nationality === 'Other' && item.json.body.otherNationality) {\n    item.json.body.nationality = item.json.body.otherNationality;\n  }\n  \n  // Process exam sessions to determine exam level and exam date\n  if (item.json.body.examSessions) {\n    const sessions = Array.isArray(item.json.body.examSessions) ? \n      item.json.body.examSessions : [item.json.body.examSessions];\n    \n    // Extract exam levels and locations from Chinese format\n    const levels = new Set();\n    const locations = new Set();\n    const examDetails = [];\n    \n    sessions.forEach(session => {\n      const parts = session.split('-');\n      if (parts.length >= 3) {\n        const location = parts[0];  // åŒ—äº¬, æˆéƒ½\n        const level = parts[1];     // A1, A2\n        const module = parts[2];    // å…¨ç§‘, ç¬”è¯•, å£è¯•\n        \n        levels.add(level);\n        locations.add(location);\n        examDetails.push({\n          location: location,\n          level: level,\n          module: module,\n          session: session\n        });\n      }\n    });\n    \n    // Set exam level\n    if (!item.json.body.examLevel || item.json.body.examLevel === '') {\n      item.json.body.examLevel = Array.from(levels).sort()[0] || 'N/A';\n    }\n    \n    // Set exam date based on selected locations\n    let examDate = 'TBD';\n    const locationArray = Array.from(locations);\n    \n    if (locationArray.includes('åŒ—äº¬') && locationArray.includes('æˆéƒ½')) {\n      examDate = '2025/8/27 (æˆéƒ½), 2025/9/6 (åŒ—äº¬)';\n    } else if (locationArray.includes('åŒ—äº¬')) {\n      examDate = '2025/9/6';\n    } else if (locationArray.includes('æˆéƒ½')) {\n      examDate = '2025/8/27';\n    }\n    \n    item.json.body.examDate = examDate;\n    item.json.body.examDetails = examDetails;\n    item.json.body.examSessionsDisplay = sessions.join(', ');\n  } else {\n    item.json.body.examDate = 'TBD';\n    item.json.body.examSessionsDisplay = 'æ— ';\n  }\n  \n  // Process payment proof attachment\n  if (item.json.body.paymentProof && item.json.body.paymentProof.content) {\n    const paymentData = item.json.body.paymentProof;\n    \n    // Convert base64 to binary buffer\n    const binaryBuffer = Buffer.from(paymentData.content, 'base64');\n    \n    // Create binary data property for payment proof\n    item.binary = item.binary || {};\n    item.binary.paymentProof = {\n      data: binaryBuffer,\n      mimeType: paymentData.mimeType || 'application/octet-stream',\n      fileName: paymentData.filename || 'payment_proof'\n    };\n    \n    // Mark payment as uploaded\n    item.json.body.paymentUploaded = true;\n  } else {\n    item.json.body.paymentUploaded = false;\n  }\n  \n  // Process signed document if still present\n  if (item.json.body.signedDocument && item.json.body.signedDocument.content) {\n    const attachmentData = item.json.body.signedDocument;\n    const binaryBuffer = Buffer.from(attachmentData.content, 'base64');\n    \n    item.binary = item.binary || {};\n    item.binary.signedDocument = {\n      data: binaryBuffer,\n      mimeType: attachmentData.mimeType || 'application/octet-stream',\n      fileName: attachmentData.filename || 'signed_document'\n    };\n  }\n  \n  // Process passport upload if present\n  if (item.json.body.passportUpload && item.json.body.passportUpload.content) {\n    const passportData = item.json.body.passportUpload;\n    const binaryBuffer = Buffer.from(passportData.content, 'base64');\n    \n    item.binary = item.binary || {};\n    item.binary.passport = {\n      data: binaryBuffer,\n      mimeType: passportData.mimeType || 'application/octet-stream',\n      fileName: passportData.filename || 'passport'\n    };\n  }\n  \n  // Add payment submission timestamp\n  if (!item.json.body.paymentSubmissionTime) {\n    item.json.body.paymentSubmissionTime = new Date().toISOString();\n  }\n  \n  // Format timestamps for display\n  item.json.body.paymentSubmissionTimeFormatted = new Date(item.json.body.paymentSubmissionTime).toLocaleString('zh-CN');\n  item.json.body.originalSubmissionTimeFormatted = new Date(item.json.body.timestamp).toLocaleString('zh-CN');\n}\n\nreturn items;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -800,
        140
      ],
      "id": "3ea97c7f-273b-43af-a5a5-8b7b2ab7d840",
      "name": "Process Payment Data"
    },
    {
      "parameters": {
        "fromEmail": "info@sdi-osd.de",
        "toEmail": "={{ $json.body.email }}",
        "subject": "=ğŸ‰ {{ $json.body.lastName }} {{ $json.body.firstName }} - SDIå¥¥å¾·è€ƒè¯•æŠ¥åæˆåŠŸç¡®è®¤å‡½",
        "html": "=<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>é‡è¦é€šçŸ¥ï¼šSDIå¥¥å¾·è€ƒè¯•æŠ¥åç¡®è®¤æ­¥éª¤</title>\n</head>\n<body>\n    <div style=\"font-family: Arial, 'Microsoft YaHei', sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #ddd; border-radius: 10px; background-color: #ffffff;\">\n\n        <!-- é‚®ä»¶ä¸»æ ‡é¢˜ -->\n        <div style=\"text-align: center; margin-bottom: 30px;\">\n            <h1 style=\"color: #F0B83F; font-size: 24px; margin: 0;\">ğŸ‰ æŠ¥åæˆåŠŸ & å¸­ä½æœ€ç»ˆç¡®è®¤å‡½</h1>\n            <hr style=\"border: none; height: 2px; background: linear-gradient(to right, #F0B83F, #FFE0B2); margin: 20px 0;\">\n        </div>\n\n        <!-- ç§°å‘¼å’Œç¥è´º -->\n        <div style=\"margin-bottom: 20px; line-height: 1.6;\">\n            <strong>äº²çˆ±çš„ {{ $json.body.lastName }} {{ $json.body.firstName }} åŒå­¦ï¼š</strong>\n            <p style=\"margin-top: 10px;\">ç¥è´ºä½ ï¼ ä½ å·²é¡ºåˆ©å®Œæˆæ…•å°¼é»‘SDIè¯­è¨€å¤§å­¦å¥¥å¾·è€ƒè¯•ä¸­å¿ƒçš„è€ƒè¯•æŠ¥ååŠç¼´è´¹æµç¨‹ï¼</p>\n            <p>ä»¥ä¸‹æ˜¯æ‚¨çš„æŠ¥åä¿¡æ¯ï¼Œè¯·æ ¸å¯¹ï¼š</p>\n        </div>\n\n        <!-- æŠ¥åä¿¡æ¯æ¨¡å— -->\n        <div style=\"background: #FFF8E1; padding: 20px; border-radius: 8px; border-left: 4px solid #F0B83F; margin: 20px 0;\">\n            <h3 style=\"color: #F0B83F; margin-top: 0;\">ğŸ“‹ æ‚¨çš„æŠ¥åä¿¡æ¯</h3>\n            <p><strong>ç”³è¯·ç¼–å·ï¼š</strong>{{ $json.body.applicationID }}</p>\n            <p><strong>æŠ¥åç­‰çº§ï¼š</strong>{{ $json.body.examLevel }}ç­‰çº§è€ƒè¯•</p>\n            <p><strong>æŠ¥åç§‘ç›®ï¼š</strong>{{ $json.body.examSessionsDisplay }}</p>\n            <p><strong>è€ƒè¯•æ—¥æœŸï¼š</strong>{{ $json.body.examDate }}</p>\n            <p><strong>æŠ¤ç…§å·ç ï¼š</strong>{{ $json.body.passportNumber }}</p>\n            <p><strong>æŠ¥åæ—¶é—´ï¼š</strong>{{ $json.body.originalSubmissionTimeFormatted }}</p>\n            <p><strong>ä»˜è´¹ç¡®è®¤æ—¶é—´ï¼š</strong>{{ $json.body.paymentSubmissionTimeFormatted }}</p>\n        </div>\n\n        <!-- å…³é”®æ“ä½œæ­¥éª¤æ¨¡å— -->\n        <div style=\"background: #E3F2FD; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n            <h3 style=\"color: #1976D2; margin-top: 0;\">ğŸ”‘ ä¸‹ä¸€æ­¥ï¼šæœ€ç»ˆç¡®è®¤æ‚¨çš„è€ƒè¯•å¸­ä½</h3>\n            <p>ä¸ºç¡®ä¿æ‚¨çš„è€ƒè¯•å¸­ä½æœ€ç»ˆè¢«ç¡®è®¤ï¼Œè¯·åŠ¡å¿…å®Œæˆä»¥ä¸‹å…³é”®æ­¥éª¤ï¼š</p>\n            <ol style=\"line-height: 1.8; padding-left: 25px;\">\n                <li><strong>ä¸‹è½½é™„ä»¶ï¼š</strong> è¯·æŸ¥æ”¶å¹¶ä¸‹è½½æœ¬é‚®ä»¶é™„ä»¶ä¸­çš„ã€Šè€ƒè¯•é¡»çŸ¥ã€‹ã€‚</li>\n                <li><strong>ä»”ç»†é˜…è¯»å¹¶ç­¾å­—ï¼š</strong> è¯·è®¤çœŸé˜…è¯»æ–‡ä»¶å†…å®¹ï¼Œå¹¶åœ¨æŒ‡å®šä½ç½®äº²ç¬”ç­¾åã€‚</li>\n                <li><strong>å›ä¼ ç­¾å­—æ–‡ä»¶ï¼š</strong> è¯·é€‰æ‹©ä»¥ä¸‹ä»»ä¸€æ–¹å¼å›ä¼ ï¼š\n                    <ul style=\"list-style-type: disc; margin-left: 20px; padding-left: 20px;\">\n                        <li><strong>æ–¹å¼ä¸€ (æ¨è)ï¼š</strong>å°†å·²ç­¾å­—çš„ã€Šè€ƒè¯•é¡»çŸ¥ã€‹ç›´æ¥ä½œä¸ºé™„ä»¶å›å¤æ­¤é‚®ä»¶ã€‚</li>\n                        <li><strong>æ–¹å¼äºŒï¼š</strong>å°†å·²ç­¾å­—çš„ã€Šè€ƒè¯•é¡»çŸ¥ã€‹æäº¤ç»™æ‚¨çš„ç•™å­¦å’¨è¯¢è€å¸ˆï¼Œç”±å…¶è½¬äº¤ç»™æˆ‘ä»¬ã€‚</li>\n                    </ul>\n                </li>\n            </ol>\n        </div>\n\n        <!-- æˆªæ­¢æ—¥æœŸæé†’æ¨¡å— -->\n        <div style=\"background: #FFF3E0; padding: 20px; border-radius: 8px; border-left: 4px solid #E65100; margin: 20px 0;\">\n            <h3 style=\"color: #E65100; margin-top: 0;\">âš ï¸ é‡è¦æˆªæ­¢æ—¥æœŸæé†’</h3>\n            <p>è¯·åŠ¡å¿…åœ¨ <strong>2025å¹´8æœˆ5æ—¥ 24:00 (åŒ—äº¬æ—¶é—´)</strong> å‰å°†ç­¾å­—æ–‡ä»¶å‘é€ç»™æˆ‘ä»¬ã€‚</p>\n            <p><strong>è‹¥æˆ‘ä»¬æœªèƒ½åœ¨æˆªæ­¢æ—¥æœŸå‰æ”¶åˆ°æ‚¨çš„ç­¾å­—æ–‡ä»¶ï¼Œå°†æ— æ³•ä¿è¯ä¸ºæ‚¨é¢„ç•™è€ƒè¯•ä½ç½®ã€‚</strong></p>\n        </div>\n        \n        <!-- åç»­æ­¥éª¤åŠè€ƒè¯•æ—¥æé†’æ¨¡å— -->\n        <div style=\"background: #F5F5F5; padding: 20px; border-radius: 8px; margin: 20px 0;\">\n            <h3 style=\"color: #333; margin-top: 0;\">ğŸ“… åç»­æ­¥éª¤åŠè€ƒè¯•æ—¥æé†’</h3>\n            <ul style=\"line-height: 1.8; padding-left: 25px;\">\n                <li><strong>æ­£å¼è€ƒè¯•ç¡®è®¤å‡½ï¼š</strong>å®Œæˆä¸Šè¿°ç­¾å­—æ­¥éª¤åï¼Œæ‚¨å°†åœ¨è€ƒå‰5-7å¤©æ”¶åˆ°æ­£å¼çš„ã€Šè€ƒè¯•ç¡®è®¤å‡½ã€‹ï¼Œå…¶ä¸­å°†åŒ…å«å…·ä½“çš„è€ƒåœºåœ°å€å’Œè¯¦ç»†æ³¨æ„äº‹é¡¹ã€‚</li>\n                <li><strong>æ‰“å°æ–‡ä»¶ï¼š</strong>æ”¶åˆ°æ­£å¼ã€Šè€ƒè¯•ç¡®è®¤å‡½ã€‹åï¼Œè¯·åŠ¡å¿…å°†å…¶æ‰“å°ä¸ºçº¸è´¨ç‰ˆã€‚</li>\n                <li><strong>æºå¸¦è¯ä»¶ï¼š</strong>è€ƒè¯•å½“å¤©å¿…é¡»æºå¸¦<strong>æŠ¤ç…§åŸä»¶</strong>åŠ<strong>çº¸è´¨ç‰ˆã€Šè€ƒè¯•ç¡®è®¤å‡½ã€‹</strong>ã€‚</li>\n                <li><strong>åˆ°è¾¾æ—¶é—´ï¼š</strong>è¯·æå‰30åˆ†é’Ÿåˆ°è¾¾è€ƒåœºã€‚</li>\n            </ul>\n        </div>\n\n        <!-- è¡¥å……è¯´æ˜ -->\n        <div style=\"margin: 30px 0; line-height: 1.6;\">\n            <p>â€» è‹¥æ‚¨åœ¨æŠ¥åæ—¶æœªæäº¤æŠ¤ç…§ä¿¡æ¯ï¼Œè¯·åŠ¡å¿…åœ¨<strong><u>è€ƒè¯•æ—¥æœŸå‰è‡³å°‘14å¤©</u></strong>å›å¤æœ¬é‚®ä»¶è¡¥å……æäº¤ã€‚</p>\n        </div>\n\n        <!-- ç»“å°¾ç¥ç¦å’Œè”ç³»æ–¹å¼ -->\n        <div style=\"margin: 30px 0; line-height: 1.6;\">\n            <p>è¯·æŠ“ç´§æ—¶é—´å®Œæˆå¸­ä½ç¡®è®¤çš„å…³é”®æ­¥éª¤ï¼Œç¥æ‚¨å¤‡è€ƒé¡ºåˆ©ï¼</p>\n            <p>å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·éšæ—¶é€šè¿‡é‚®ä»¶è”ç³»æˆ‘ä»¬ï¼š<a href=\"mailto:info@sdi-osd.de\" style=\"color: #F0B83F; text-decoration: none;\">info@sdi-osd.de</a></p>\n        </div>\n\n        <hr style=\"border: none; height: 1px; background: #ddd; margin: 30px 0;\">\n\n        <!-- é‚®ä»¶é¡µè„š -->\n        <div style=\"font-size: 14px; color: #666; text-align: center; line-height: 1.6;\">\n            <p><strong>SDI Internationale Hochschule MÃ¼nchen</strong><br>Kontakt: info@sdi-osd.de</p>\n            <p><strong>æ…•å°¼é»‘SDIè¯­è¨€å¤§å­¦</strong><br>å¥¥å¾·è€ƒè¯•ä¸­å¿ƒ</p>\n        </div>\n\n    </div>\n</body>\n</html>\n",
        "attachments": "notification",
        "options": {}
      },
      "name": "Send Success Email to Student",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 1,
      "position": [
        -200,
        140
      ],
      "id": "622c19f8-fd30-48e0-aabb-f3ecd94c36d2",
      "credentials": {
        "smtp": {
          "id": "evEHcleKBaWVF93k",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "info@sdi-osd.de",
        "toEmail": "skee.chen@xuezaideguo.com",
        "subject": "=ğŸ’° å­¦ç”Ÿå·²å®Œæˆä»˜è´¹ - {{ $json.body.lastName }} {{ $json.body.firstName }}",
        "html": "=<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\"><h2 style=\"color: #4CAF50;\">âœ… å­¦ç”Ÿå·²å®Œæˆä»˜è´¹</h2><div style=\"background: #E8F5E8; padding: 15px; border-radius: 8px; margin: 20px 0;\"><h3>ğŸ‘¤ å­¦ç”Ÿä¿¡æ¯</h3><p>â€¢ <strong>ç”³è¯·ç¼–å·ï¼š</strong>{{ $json.body.applicationID }} </p><p>â€¢ <strong>å§“åï¼š</strong>{{ $json.body.lastName }} {{ $json.body.firstName }}</p><p>â€¢ <strong>æ€§åˆ«ï¼š</strong>{{ $json.body.gender }}</p><p>â€¢ <strong>å‡ºç”Ÿæ—¥æœŸï¼š</strong>{{ $json.body.birthDate }}</p><p>â€¢ <strong>å›½ç±ï¼š</strong>{{ $json.body.nationality }}</p><p>â€¢ <strong>å‡ºç”Ÿåœ°ï¼š</strong>{{ $json.body.birthPlace }}</p><p>â€¢ <strong>é‚®ç®±ï¼š</strong>{{ $json.body.email }}</p><p>â€¢ <strong>æ‰‹æœºå·ç ï¼š</strong>{{ $json.body.phoneNumber }}</p><p>â€¢ <strong>æŠ¤ç…§å·ç ï¼š</strong>{{ $json.body.passportNumber }}</p></div><div style=\"background: #FFF3E0; padding: 15px; border-radius: 8px; margin: 20px 0;\"><h3>ğŸ“š è€ƒè¯•ä¿¡æ¯</h3><p>â€¢ <strong>è€ƒè¯•åœºæ¬¡ï¼š</strong>{{ $json.body.examSessionsDisplay }}</p><p>â€¢ <strong>è€ƒè¯•æ—¥æœŸï¼š</strong>{{ $json.body.examDate }}</p><p>â€¢ <strong>è€ƒè¯•ç­‰çº§ï¼š</strong>{{ $json.body.examLevel }}</p></div><div style=\"background: #E3F2FD; padding: 15px; border-radius: 8px; margin: 20px 0;\"><h3>â° æ—¶é—´ä¿¡æ¯</h3><p>â€¢ <strong>æŠ¥åæ—¶é—´ï¼š</strong>{{ $json.body.originalSubmissionTimeFormatted }}</p><p>â€¢ <strong>ä»˜è´¹æ—¶é—´ï¼š</strong>{{ $json.body.paymentSubmissionTimeFormatted }}</p></div><div style=\"background: #FFEBEE; padding: 15px; border-radius: 8px; margin: 20px 0;\"><h3>ğŸ“ é™„ä»¶ä¿¡æ¯</h3><p>â€¢ <strong>ä»˜è´¹å‡­è¯ï¼š</strong>{{ $json.body.paymentProof ? $json.body.paymentProof.filename : 'æœªä¸Šä¼ ' }}</p><p>â€¢ <strong>æŠ¤ç…§ä¿¡æ¯ï¼š</strong>{{ $json.body.passportUpload ? $json.body.passportUpload.filename : 'æœªä¸Šä¼ ' }}</p></div><p style=\"margin-top: 30px; font-size: 14px; color: #666;\">è¯·åŠæ—¶å¤„ç†å­¦ç”Ÿçš„ä»˜è´¹ç¡®è®¤ï¼Œå¿…è¦æ—¶å¯è”ç³»å­¦ç”Ÿè¿›è¡Œç¡®è®¤ã€‚</p></div>",
        "attachments": "={{ $binary.paymentProof ? ($binary.passport ? ($binary.signedDocument ? 'paymentProof,passport,signedDocument' : 'paymentProof,passport') : ($binary.signedDocument ? 'paymentProof,signedDocument' : 'paymentProof')) : ($binary.passport ? ($binary.signedDocument ? 'passport,signedDocument' : 'passport') : ($binary.signedDocument ? 'signedDocument' : '')) }}",
        "options": {}
      },
      "name": "Send Payment Alert to Admin",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 1,
      "position": [
        -360,
        -60
      ],
      "id": "3876a18c-86c8-4cb0-a6aa-b2d7c624e450",
      "credentials": {
        "smtp": {
          "id": "evEHcleKBaWVF93k",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1GBu2AgIhKBJE5q34Hk6s6DL6fRaTW-yqiZMf8blVNd0",
          "mode": "list",
          "cachedResultName": "test_registration_sheet"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1GBu2AgIhKBJE5q34Hk6s6DL6fRaTW-yqiZMf8blVNd0/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "paymentUploaded": "={{ $json.body.paymentUploaded ? 'TRUE' : 'FALSE' }}",
            "applicationID": "={{ $json.body.applicationID }}"
          },
          "matchingColumns": [
            "applicationID"
          ],
          "schema": [
            {
              "id": "ChineseName",
              "displayName": "ChineseName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "FirstName",
              "displayName": "FirstName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "LastName",
              "displayName": "LastName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Gender",
              "displayName": "Gender",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "BirthDate",
              "displayName": "BirthDate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Nationality",
              "displayName": "Nationality",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "BirthPlace",
              "displayName": "BirthPlace",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Passport",
              "displayName": "Passport",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "E-mail",
              "displayName": "E-mail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Mobile",
              "displayName": "Mobile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "First_Time",
              "displayName": "First_Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A2_BJ_Written",
              "displayName": "A2_BJ_Written",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A2_BJ_Oral",
              "displayName": "A2_BJ_Oral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A1_BJ_Written",
              "displayName": "A1_BJ_Written",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A1_BJ_Oral",
              "displayName": "A1_BJ_Oral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A2_CD_Written",
              "displayName": "A2_CD_Written",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A2_CD_Oral",
              "displayName": "A2_CD_Oral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A1_CD_Written",
              "displayName": "A1_CD_Written",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A1_CD_Oral",
              "displayName": "A1_CD_Oral",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TestDate",
              "displayName": "TestDate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PassportUploaded",
              "displayName": "PassportUploaded",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Reg_Time",
              "displayName": "Reg_Time",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "paymentUploaded",
              "displayName": "paymentUploaded",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "applicationID",
              "displayName": "applicationID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -360,
        340
      ],
      "id": "6027bca3-92ab-43d8-90fb-b576073cdadf",
      "name": "Update Payment Status in Sheets",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "OWrqKQaJ59Y0WeAD",
          "name": "Skee's Google Sheet"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"message\": \"ä»˜è´¹å‡­è¯ä¸Šä¼ æˆåŠŸï¼æŠ¥åæµç¨‹å·²å®Œæˆã€‚\",\n  \"data\": {\n    \"studentName\": \"{{ $json.body.lastName }} {{ $json.body.firstName }}\",\n    \"examDate\": \"{{ $json.body.examDate }}\",\n    \"examSessions\": \"{{ $json.body.examSessionsDisplay }}\",\n    \"paymentConfirmed\": true,\n    \"emailSent\": true,\n    \"timestamp\": \"{{ $json.body.paymentSubmissionTime }}\"\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        100,
        140
      ],
      "id": "14f60174-3cf7-4cca-aece-23fea27f2780",
      "name": "Respond Success to Frontend"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1oIMEWuzNuj_8zwEY1-I9oDYPDMeVrP5y",
          "mode": "list",
          "cachedResultName": "SDI_exam_notification.pdf",
          "cachedResultUrl": "https://drive.google.com/file/d/1oIMEWuzNuj_8zwEY1-I9oDYPDMeVrP5y/view?usp=drivesdk"
        },
        "options": {
          "binaryPropertyName": "notification"
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -480,
        140
      ],
      "id": "1638b9bd-1b3b-41a7-9481-0f20174b77f4",
      "name": "Google Drive",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "zsMGAxLZF0nMTMQI",
          "name": "Skee's google drive"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Process Payment Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Payment Data": {
      "main": [
        [
          {
            "node": "Send Payment Alert to Admin",
            "type": "main",
            "index": 0
          },
          {
            "node": "Update Payment Status in Sheets",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Success Email to Student": {
      "main": [
        [
          {
            "node": "Respond Success to Frontend",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Payment Alert to Admin": {
      "main": [
        [
          {
            "node": "Respond Success to Frontend",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Payment Status in Sheets": {
      "main": [
        [
          {
            "node": "Respond Success to Frontend",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive": {
      "main": [
        [
          {
            "node": "Send Success Email to Student",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "0348d493-e1aa-4102-850a-67ce7221df56",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "62c4f474723b914af91e4af15e30298257d6540140abed5d09006251f9987da1"
  },
  "id": "w21ppoxXphu7og7S",
  "tags": []
}